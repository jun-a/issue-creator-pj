{% extends "base.html" %}

{% block content %}
<div class="columns">
    <div class="column is-8 is-offset-2">
        <h1 class="title">Issue History</h1>
        
        {% if issues %}
        <div class="table-container">
            <table class="table is-fullwidth is-hoverable">
                <thead>
                    <tr>
                        <th>Title</th>
                        <th>Created</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for issue in issues %}
                    <tr>
                        <td>{{ issue.title }}</td>
                        <td>{{ issue.created_at }}</td>
                        <td>
                            <div class="buttons are-small">
                                <a href="/preview/{{ issue.id }}" class="button is-info">
                                    <span class="icon"><i class="fas fa-eye"></i></span>
                                    <span>Preview</span>
                                </a>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="notification is-warning">
            No issues found. <a href="/">Create your first issue</a>.
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    document.body.addEventListener('htmx:error', function(evt) {
        const errorNotification = document.getElementById('error-notification');
        const errorMessage = document.getElementById('error-message');
        errorMessage.textContent = evt.detail.error;
        errorNotification.classList.remove('is-hidden');
    });
</script>
{% endblock %}